<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gửi file</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.3.1/peerjs.min.js"
        integrity="sha512-wNUAk/IKoDcVSiKiN/0ormRTzENc9IbFdHa/BWNuLPtp2kG53TLf5dobOeCHoeafnlaSfjKAiSewS6AJspm/Iw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    Gửi file<br>
    Tạo ID phòng:
    <input type="text" id="idphong">
    <input type="button" value="Tạo" onclick="tao()">
    <br><br>
    <input type="file" id="file" />
</body>

<script>
    var ketnoi = null;
    function tao() {
        // tạo id phòng
        var idphong = "ekRSeVBkOWt1c3BqcGZvZ3ZTcHA4bGNReVd1NWNQ" + $("#idphong").val();
        var peer = new Peer(idphong);

        // bắt đầu kết nối
        peer.on('connection', (conn) => {
            ketnoi1(conn);
        });


    }
  
    function ketnoi1(a) {
        ketnoi = a;
    }

      // Lấy dữ liệu file để gửi
    document.querySelector('#file').onchange = function (event) {
        const file = event.target.files[0]
        const blob = new Blob(event.target.files, { type: file.type });
        ketnoi.send({
            file: blob,
            filename: file.name,
            filetype: file.type
        })
    }
</script>

</html>